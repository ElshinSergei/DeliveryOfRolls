<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/main-layout :: html(content=~{::main})}">
<head>
    <meta charset="UTF-8">
    <title th:text="${pageTitle}">RedRolls - –ì–ª–∞–≤–Ω–∞—è</title>

</head>
<body>
<main>

    <div style="max-width: 1200px; margin: 0 auto; padding: 20px;">

        <div style="display: grid; grid-template-columns: 300px 1fr; gap: 30px;">
            <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                <div style="text-align: center; margin-bottom: 30px;">
                    <div style="font-size: 80px; color: #dc3545;">üë§</div>
                    <h3 th:text="${user.firstName + ' ' + user.lastName}">–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤</h3>
                    <p style="color: #666;" th:text="${user.email}">ivan@mail.com</p>
                </div>

                <hr>

                <ul style="list-style: none; padding: 0;">
                    <li style="margin-bottom: 10px;">
                        <a href="/profile" style="display: block; padding: 10px; background: #dc3545; color: white; text-decoration: none; border-radius: 5px;">
                            üìã –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å
                        </a>
                    </li>
                    <li style="margin-bottom: 10px;">
                        <a href="/profile/orders" style="display: block; padding: 10px; background: #6c757d; color: white; text-decoration: none; border-radius: 5px;">
                            üì¶ –ú–æ–∏ –∑–∞–∫–∞–∑—ã
                        </a>
                    </li>
                    <li style="margin-bottom: 10px;">
                        <a href="/profile/edit" style="display: block; padding: 10px; background: #28a745; color: white; text-decoration: none; border-radius: 5px;">
                            ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
                        </a>
                    </li>
                </ul>
            </div>

            <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
            <div class="content">
                <!-- –°—Å—ã–ª–∫–∞ –Ω–∞–∑–∞–¥ -->
                <a href="/profile/orders" class="back-link">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É –∑–∞–∫–∞–∑–æ–≤</a>

                <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞–∫–∞–∑–∞ -->
                <div class="order-header">
                    <h1 class="order-title">–ó–∞–∫–∞–∑ <span class="order-id">#[[${order.id}]]</span></h1>
                    <span th:if="${order.status.name() == 'PENDING'}" class="badge badge-warning">‚è≥ –û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è</span>
                    <span th:if="${order.status.name() == 'CONFIRMED'}" class="badge badge-info">‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω</span>
                    <span th:if="${order.status.name() == 'PREPARING'}" class="badge badge-primary">üë®‚Äçüç≥ –ì–æ—Ç–æ–≤–∏—Ç—Å—è</span>
                    <span th:if="${order.status.name() == 'READY_FOR_DELIVERY'}" class="badge badge-secondary">üì¶ –ì–æ—Ç–æ–≤ –∫ –≤—ã–¥–∞—á–µ</span>
                    <span th:if="${order.status.name() == 'ON_THE_WAY'}" class="badge badge-dark">üöö –í –ø—É—Ç–∏</span>
                    <span th:if="${order.status.name() == 'DELIVERED'}" class="badge badge-success">üèÅ –î–æ—Å—Ç–∞–≤–ª–µ–Ω</span>
                    <span th:if="${order.status.name() == 'COMPLETED'}" class="badge badge-secondary">‚ú® –ó–∞–≤–µ—Ä—à–µ–Ω</span>
                    <span th:if="${order.status.name() == 'CANCELLED'}" class="badge badge-danger">‚ùå –û—Ç–º–µ–Ω–µ–Ω</span>
                </div>

                <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
                <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
                <div th:if="${error}" class="alert alert-error" th:text="${error}"></div>

                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–∫–∞–∑–µ -->
                <div class="info-section">
                    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Å—Ç–∞–≤–∫–µ -->
                    <div class="info-card">
                        <h3>–î–æ—Å—Ç–∞–≤–∫–∞</h3>
                        <div class="info-row">
                            <span class="info-label">–¢–∏–ø:</span>
                            <span class="info-value" th:text="${order.deliveryType.name() == 'DELIVERY' ? '–î–æ—Å—Ç–∞–≤–∫–∞ –∫—É—Ä—å–µ—Ä–æ–º' : '–°–∞–º–æ–≤—ã–≤–æ–∑'}">
                                –î–æ—Å—Ç–∞–≤–∫–∞ –∫—É—Ä—å–µ—Ä–æ–º
                            </span>
                        </div>
                        <div th:if="${order.deliveryType.name() == 'DELIVERY' and order.deliveryAddress != null}" class="info-row">
                            <span class="info-label">–ê–¥—Ä–µ—Å:</span>
                            <span class="info-value" th:text="${order.deliveryAddress}">—É–ª. –ü—É—à–∫–∏–Ω–∞, –¥. 10</span>
                        </div>
                        <div th:if="${order.deliveryTime != null}" class="info-row">
                            <span class="info-label">–í—Ä–µ–º—è:</span>
                            <span class="info-value" th:text="${#temporals.format(order.deliveryTime, 'dd.MM.yyyy HH:mm')}">
                                15.02.2026 18:30
                            </span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">–î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞:</span>
                            <span class="info-value" th:text="${#temporals.format(order.createdAt, 'dd.MM.yyyy HH:mm')}">
                                15.02.2026 15:30
                            </span>
                        </div>
                    </div>

                    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–ø–ª–∞—Ç–µ -->
                    <div class="info-card">
                        <h3>–û–ø–ª–∞—Ç–∞</h3>
                        <div class="info-row">
                            <span class="info-label">–°–ø–æ—Å–æ–±:</span>
                            <span class="info-value" th:text="${order.paymentMethod.name() == 'CASH' ? '–ù–∞–ª–∏—á–Ω—ã–º–∏' :
                                                              order.paymentMethod.name() == 'CARD_ON_DELIVERY' ? '–ö–∞—Ä—Ç–æ–π –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏' :
                                                              order.paymentMethod.name() == 'CARD_ONLINE' ? '–ö–∞—Ä—Ç–æ–π –æ–Ω–ª–∞–π–Ω' : '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}">
                                –ù–∞–ª–∏—á–Ω—ã–º–∏
                            </span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">–°—Ç–∞—Ç—É—Å:</span>
                            <span class="info-value">–û–ø–ª–∞—Ç–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</span>
                        </div>
                    </div>
                </div>

                <!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É -->
                <div th:if="${order.notes != null and !order.notes.isEmpty()}" class="special-instructions">
                    <h4>üìù –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É</h4>
                    <p th:text="${order.notes}">–ü–æ–∑–≤–æ–Ω–∏—Ç—å –∑–∞ 10 –º–∏–Ω—É—Ç, –¥–æ–º–æ—Ñ–æ–Ω 123</p>
                </div>

                <!-- –°–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞ -->
                <h3 style="margin: 30px 0 15px;">–°–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞</h3>
                <div class="table-responsive">
                    <table class="items-table">
                        <thead>
                        <tr>
                            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                            <th class="text-center">–ö–æ–ª-–≤–æ</th>
                            <th class="text-right">–¶–µ–Ω–∞</th>
                            <th class="text-right">–°—É–º–º–∞</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="item : ${order.items}">
                            <td>
                                <span th:text="${item.dishName}">–§–∏–ª–∞–¥–µ–ª—å—Ñ–∏—è</span>
                                <span th:if="${item.specialInstructions != null and !item.specialInstructions.isEmpty()}"
                                      style="display: block; font-size: 12px; color: #666;">
                                        üìù <span th:text="${item.specialInstructions}">–±–µ–∑ —Å–æ—É—Å–∞</span>
                                    </span>
                            </td>
                            <td class="text-center" th:text="${item.quantity}">2</td>
                            <td class="text-right" th:text="${#numbers.formatDecimal(item.priceAtOrder, 0, 0)} + ' ‚ÇΩ'">350 ‚ÇΩ</td>
                            <td class="text-right item-total" th:text="${#numbers.formatDecimal(item.totalPrice, 0, 0)} + ' ‚ÇΩ'">700 ‚ÇΩ</td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <!-- –ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ -->
                <div class="order-total">
                    <span class="total-label">–ò—Ç–æ–≥–æ:</span>
                    <span class="total-amount" th:text="${#numbers.formatDecimal(order.totalPrice, 0, 0)} + ' ‚ÇΩ'">1250 ‚ÇΩ</span>
                </div>

                <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
                <div class="order-actions">
                    <a href="/profile/orders" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥</a>
                    <form th:action="@{/profile/orders/{id}/repeat(id=${order.id})}" method="post" style="display: inline;">
                        <button type="submit" class="btn btn-primary"
                                th:disabled="${order.status.name() == 'CANCELLED'}">
                            üîÑ –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

</main>
</body>
</html>